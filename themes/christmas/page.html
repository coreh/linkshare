<!DOCTYPE html>
<html lang="{{locale}}" dir="{{dir}}" class="{{dc "dark" ""}}">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>{{title}}</title>
  {{#if description}}
  <meta name="description" content="{{description}}">
  {{/if}}
  <script src="https://cdn.tailwindcss.com?plugins=forms,typography,aspect-ratio,container-queries"></script>
  <script>
    tailwind.config = {
      darkMode: 'class',
      theme: {
        extend: {
          colors: {
            accent: {
              50: 'var(--c-50)',
              100: 'var(--c-100)',
              200: 'var(--c-200)',
              300: 'var(--c-300)',
              400: 'var(--c-400)',
              500: 'var(--c-500)',
              600: 'var(--c-600)',
              700: 'var(--c-700)',
              800: 'var(--c-800)',
              900: 'var(--c-900)',
              950: 'var(--c-950)',
            }
          }
        }
      }
    }
  </script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Mountains+of+Christmas:wght@400;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github-dark.min.css" media="(prefers-color-scheme: dark)">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github.min.css" media="(prefers-color-scheme: light)">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
  <style>
    :root {
      --c-50: #fef2f2;
      --c-100: #fee2e2;
      --c-200: #fecaca;
      --c-300: #fca5a5;
      --c-400: #f87171;
      --c-500: #ef4444;
      --c-600: #dc2626;
      --c-700: #b91c1c;
      --c-800: #991b1b;
      --c-900: #7f1d1d;
      --c-950: #450a0a;
    }
    body {
      font-family: 'Mountains of Christmas', cursive;
      background-color: {{dc background_color_dark background_color_light}};
    }
    {{{theme_css}}}
  </style>
  {{#if auto_dark}}
  <script>
    if (localStorage.theme === 'dark' || (!('theme' in localStorage) && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
      document.documentElement.classList.add('dark')
    } else {
      document.documentElement.classList.remove('dark')
    }
  </script>
  {{/if}}
  <script>
    function toggleMaximize(btn) {
      const container = btn.closest('[data-embed-container]');
      if (!container) return;

      if (container.classList.contains('ls-embed-maximized')) {
        container.classList.remove('ls-embed-maximized');
        btn.textContent = '‚õ∂';
        document.body.style.overflow = '';
      } else {
        container.classList.add('ls-embed-maximized');
        btn.textContent = '‚úï';
        document.body.style.overflow = 'hidden';
      }
    }
  </script>
</head>
<body class="{{dc "bg-red-950 text-red-100" "bg-red-50 text-red-900"}} min-h-screen">
  <div class="container mx-auto px-4 py-8 max-w-4xl">
    <!-- Header -->
    <header class="text-center mb-12">
      {{#if logo}}
      <img src="{{logo}}" alt="{{title}}" class="mx-auto mb-4 max-w-xs">
      {{/if}}
      <h1 class="text-5xl font-bold mb-2 christmas-sparkle">üéÑ {{title}} üéÑ</h1>
      {{#if description}}
      <p class="text-xl {{muted}}">{{description}}</p>
      {{/if}}
    </header>

    <!-- Navigation -->
    {{#if show_nav}}
    <nav class="mb-8 flex items-center justify-between">
      {{#if parent.path}}
      <a href="{{parent.path}}" class="{{hover_text}} flex items-center gap-2">
        <span>{{t "‚Üê Back"}}</span>
      </a>
      {{else}}
      <div></div>
      {{/if}}

      {{#if auto_dark}}
      <button onclick="document.documentElement.classList.toggle('dark'); localStorage.theme = document.documentElement.classList.contains('dark') ? 'dark' : 'light';" class="{{hover_text}} text-2xl">
        {{dc "‚òÄÔ∏è" "üåô"}}
      </button>
      {{/if}}
    </nav>
    {{/if}}

    <!-- Children sections -->
    {{#if children_html}}
    <div class="grid gap-4 mb-8">
      {{{children_html}}}
    </div>
    {{/if}}

    <!-- Items -->
    {{#if items_html}}
    <div class="grid gap-4">
      {{{items_html}}}
    </div>
    {{/if}}

    <!-- Footer -->
    <footer class="mt-16 text-center {{muted}}">
      <p class="text-lg">{{t "‚≠ê Wishing you a magical holiday season! ‚≠ê"}}</p>
      <p class="text-sm mt-2">{{t "üéÅ Powered by LinkShare üéÅ"}}</p>
    </footer>
  </div>

  <canvas class="ls-snow-canvas" id="snowCanvas"></canvas>
  <script>
  (function() {
    var canvas = document.getElementById('snowCanvas');
    var ctx = canvas.getContext('2d');
    var W, H, N = 180, PR = 6, MP = 28, TAPER = 8;
    var flakes = [], surfs = [], wind = 0, wt = 0, fc = 0, seeded = false;

    function sz() { W = canvas.width = innerWidth; H = canvas.height = innerHeight; }
    sz();
    addEventListener('resize', function() { sz(); scan(); });

    function taperAt(col, len) {
      var edge = Math.min(col, len - 1 - col);
      return Math.min(1, edge / TAPER);
    }

    function scan() {
      var sy = scrollY, old = surfs;
      surfs = [];
      var els = document.querySelectorAll(
        '[class*="rounded"][class*="border"],[class*="border"][class*="rounded"],[data-embed-container]'
      );
      for (var i = 0; i < els.length; i++) {
        var r = els[i].getBoundingClientRect();
        if (r.width < 40 || r.height < 15) continue;
        var dt = Math.round(r.top + sy), l = Math.round(r.left), ri = Math.round(r.right);
        var cols = Math.ceil((ri - l) / PR), pile = null;
        for (var j = 0; j < old.length; j++) {
          if (Math.abs(old[j].t - dt) < 8 && Math.abs(old[j].l - l) < 8 && old[j].p.length === cols) {
            pile = old[j].p; old.splice(j, 1); break;
          }
        }
        if (!pile) pile = new Float32Array(cols);
        surfs.push({ l: l, r: ri, t: dt, p: pile });
      }
      if (!seeded && surfs.length > 0) {
        seeded = true;
        for (var j = 0; j < surfs.length; j++) {
          var p = surfs[j].p;
          for (var k = 0; k < p.length; k++)
            p[k] = (1 + Math.random() * 2 + Math.sin(k * 0.3)) * taperAt(k, p.length);
          for (var pass = 0; pass < 3; pass++)
            for (var k = 1; k < p.length - 1; k++)
              p[k] = (p[k - 1] + p[k] * 2 + p[k + 1]) / 4;
        }
      }
    }

    function mk(full) {
      return {
        x: Math.random() * W, y: full ? Math.random() * H : -Math.random() * 40 - 5,
        r: Math.random() * 2.5 + 0.8, sp: Math.random() * 1.2 + 0.4,
        wb: Math.random() * 6.28, ws: Math.random() * 0.02 + 0.005,
        o: Math.random() * 0.5 + 0.3
      };
    }

    for (var i = 0; i < N; i++) flakes.push(mk(true));
    scan();

    function frame() {
      ctx.clearRect(0, 0, W, H);
      var sy = scrollY;
      if (++fc % 120 === 0) scan();

      wt += (Math.random() - 0.5) * 0.02;
      wt = Math.max(-0.4, Math.min(0.4, wt));
      wind += (wt - wind) * 0.01;

      for (var i = 0; i < N; i++) {
        var f = flakes[i];
        f.wb += f.ws;
        f.x += Math.sin(f.wb) * 0.5 + wind;
        f.y += f.sp;
        var dy = f.y + sy, hit = false;

        for (var j = 0; j < surfs.length; j++) {
          var s = surfs[j];
          if (f.x >= s.l && f.x < s.r) {
            var col = Math.floor((f.x - s.l) / PR);
            if (col >= 0 && col < s.p.length) {
              var tp = taperAt(col, s.p.length);
              var cap = MP * tp;
              if (dy >= s.t - s.p[col] && s.p[col] < cap) {
                var a = (0.4 + Math.random() * 0.3) * tp;
                s.p[col] = Math.min(cap, s.p[col] + a);
                if (col > 0) s.p[col - 1] = Math.min(MP * taperAt(col - 1, s.p.length), s.p[col - 1] + a * 0.3);
                if (col < s.p.length - 1) s.p[col + 1] = Math.min(MP * taperAt(col + 1, s.p.length), s.p[col + 1] + a * 0.3);
                hit = true; break;
              }
            }
          }
        }

        if (hit || f.y > H + 5) { flakes[i] = mk(false); continue; }
        if (f.x > W + 5) f.x = -5;
        if (f.x < -5) f.x = W + 5;

        ctx.beginPath();
        ctx.arc(f.x, f.y, f.r, 0, 6.28);
        ctx.fillStyle = 'rgba(255,255,255,' + f.o + ')';
        ctx.fill();
      }

      // Settle piles
      for (var j = 0; j < surfs.length; j++) {
        var p = surfs[j].p;
        for (var k = 1; k < p.length - 1; k++)
          p[k] += ((p[k - 1] + p[k + 1]) / 2 - p[k]) * 0.03;
      }

      // Draw piles
      for (var j = 0; j < surfs.length; j++) {
        var s = surfs[j], by = s.t - sy;
        if (by < -MP - 5 || by > H + 5) continue;
        var any = false;
        for (var k = 0; k < s.p.length; k++) { if (s.p[k] > 0.3) { any = true; break; } }
        if (!any) continue;

        ctx.beginPath();
        ctx.moveTo(s.l, by);
        for (var k = 0; k < s.p.length; k++) {
          var px = s.l + (k + 0.5) * PR, py = by - s.p[k];
          if (k === 0) ctx.lineTo(px, py);
          else {
            var ox = s.l + (k - 0.5) * PR, oy = by - s.p[k - 1];
            ctx.quadraticCurveTo(ox, oy, (ox + px) / 2, (oy + py) / 2);
          }
        }
        ctx.lineTo(s.l + (s.p.length - 0.5) * PR, by - s.p[s.p.length - 1]);
        ctx.lineTo(s.r, by);
        ctx.closePath();

        ctx.fillStyle = 'rgba(255,255,255,0.85)';
        ctx.fill();
        ctx.strokeStyle = 'rgba(200,220,255,0.25)';
        ctx.lineWidth = 0.5;
        ctx.stroke();
      }

      requestAnimationFrame(frame);
    }
    frame();
  })();
  </script>
</body>
</html>
